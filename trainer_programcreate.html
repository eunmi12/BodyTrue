<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BodyTrue</title>
    <link rel="stylesheet" href="trainer_programcreate.css">
</head>
<body>
    <header>
        <div class="wrap">
            <div class="nav_left">
                <h1>
                    <a class="logo" href="#"><img src="./image/BODYTRUE.png" alt="logo"></a>
                </h1>
            </div>
            <div class="nav_right">
                <ul class="icon_list">
                    <li class="item"><a class="icon" href="#"><img src="./image/icon.png" alt="logout">로그아웃</a></li>
                </ul>
            </div>
        </div>
    </header>
    <div class="prc_main">
        <div class="prc_title">
            <p>프로그램 등록</p>
        </div>
        <div class="prc_content">
            <div class="content_left">
                <div class="upload_img">
                    <div class="img-box">
                        <img id="profile-picture" class="profile-picture" src="./image/running.png" alt="Profile Picture">
                    </div>
                    <input type="file" id="image-upload" accept="image/*">
                    <label for="image-upload" class="file-upload-label" style="padding-left: 50px;">썸네일이미지 선택</label><br>   
                    <span>사이즈(256 * 256)이내</span>
                </div>
            </div>
            <div class="content_right">
                <div class="prc_name">
                    <div class="prcn_title">
                        <span>프로그램 명</span>
                    </div>
                    <input type="text" id="prcn_text" placeholder="프로그램 명">
                </div>
                <div class="prc_name">
                    <div class="prcn_title">
                        <span>전화번호</span>
                    </div>
                    <input type="text" id="phn_text" placeholder="010-1111-1111">
                </div>
                <div class="prc_name">
                    <div class="prcn_title">
                        <span>주소</span>
                    </div>
                    <input type="submit" id="address_text" value="주소">
                </div>
                <div class="prc_name">
                    <div class="prc_date">
                        <div class="prcn_title">
                            <span>시작일</span>
                        </div>
                        <input type="date" id="start_date" value="달력">
                    </div>
                    <div class="prc_date">
                        <div class="prcn_title">
                            <span>마감일</span>
                        </div>
                        <input type="date" id="end_date" value="달력">
                    </div>
                </div>
                <div class="prc_detail prc_tag">
                    <div class="detail_title detail_tag">
                        <span>상세 설명</span>
                        <div class="tags">
                            <label for="diet">
                                <input type="checkbox" name="tag" id="diet" value="다이어트"><span>다이어트</span>
                            </label>
                            <label for="bodychange">
                                <input type="checkbox" name="tag" id="bodychange" value="체형교정"><span>체형교정</span>
                            </label>
                            <label for="tournament">
                                <input type="checkbox" name="tag" id="tournament" value="대회"><span>대회</span>
                            </label>
                            <label for="strength">
                                <input type="checkbox" name="tag" id="strength" value="체력증진"><span>체력증진</span>
                            </label>
                            <label for="hometraining">
                                <input type="checkbox" name="tag" id="hometraining" value="홈트"><span>홈트</span>
                            </label>
                        </div>
                    </div>
                    <div class="img_upload">
                        <div class="img_content">
                            <span>상세 이미지 - 1</span>
                        </div>
                        <input type="file" class="prcimg_upload" id="file-input1" accept="image/png, image/jpeg"  multiple accept="image/*">                        
                    </div>
                    <div class="preview-container" id="preview-container"></div>
                    <div class="img_textarea">
                        <textarea name="img_textarea" id="img_textarea" placeholder="상세 이미지 설명"></textarea>
                    </div>
                </div>
                <div class="prc_detail">
                    <div class="img_upload">
                        <div class="img_content">
                            <span>상세 이미지 - 2</span>
                        </div>
                        <input type="file" class="prcimg_upload" id="file-input2" accept="image/png, image/jpeg"  multiple accept="image/*">
                    </div>
                    <div class="preview-container" id="preview-container2"></div>
                    <div class="img_textarea">
                        <textarea name="img_textarea" id="img_textarea" placeholder="상세 이미지 설명"></textarea>
                    </div>
                </div>
                <div class="prc_price">
                    <div class="img_title">
                        <span>가격</span>
                    </div>
                    <div class="img_upload">
                        <div class="img_content">
                            <span>가격</span>
                        </div>
                        <input type="file" class="prcimg_upload" id="file-input3" accept="image/png, image/jpeg"  multiple accept="image/*">
                    </div>
                    <div class="preview-container" id="preview-container3"></div>
                </div>
            </div>
        </div>
        <div class="prc_btn">
            <button type="button" name="create" id="prc_create">등록</button>
            <button type="button" name="cancle" id="prc_cancel">취소</button>
        </div>
    </div>
</body>
</html>
<script>
    const imageUpload = document.getElementById('image-upload');
    const profilePicture = document.getElementById('profile-picture');
    const maxFiles = 5;

    document.getElementById('file-input1').addEventListener('change', function(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('preview-container');
            previewContainer.innerHTML = ''; // Clear any existing previews

            if (files.length > maxFiles) {
                alert(`You can only upload a maximum of ${maxFiles} images.`);
                event.target.value = ''; // Clear the file input
                return;
            }

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    previewContainer.appendChild(img);
                }
                reader.readAsDataURL(file);
            });
        });

    document.getElementById('file-input2').addEventListener('change', function(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('preview-container2');
            previewContainer.innerHTML = ''; // Clear any existing previews

            if (files.length > maxFiles) {
                alert(`You can only upload a maximum of ${maxFiles} images.`);
                event.target.value = ''; // Clear the file input
                return;
            }

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    previewContainer.appendChild(img);
                }
                reader.readAsDataURL(file);
            });
        });

    document.getElementById('file-input3').addEventListener('change', function(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('preview-container3');
            previewContainer.innerHTML = ''; // Clear any existing previews

            if (files.length > maxFiles) {
                alert(`You can only upload a maximum of ${maxFiles} images.`);
                event.target.value = ''; // Clear the file input
                return;
            }

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    previewContainer.appendChild(img);
                }
                reader.readAsDataURL(file);
            });
        });
            
        imageUpload.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            // 이미지 파일 형식 검사
            const validImageTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            if (!validImageTypes.includes(file.type)) {
                alert('유효하지 않은 이미지 형식입니다. JPEG, PNG, GIF, WEBP 파일만 업로드 가능합니다.');
                return;
            }

            // 이미지 파일 크기 검사 (예: 5MB 이하)
            const maxSizeInMB = 5;
            const maxSizeInBytes = maxSizeInMB * 1024 * 1024;
            if (file.size > maxSizeInBytes) {
                alert(`이미지 파일 크기가 너무 큽니다. ${maxSizeInMB}MB 이하의 파일을 업로드해주세요.`);
                return;
            }

            // 이미지 파일의 실제 너비와 높이를 검사
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const maxWidth = 1000;  // 최대 너비 (픽셀)
                    const maxHeight = 1000; // 최대 높이 (픽셀)
                    const minWidth = 400;  // 최소 너비 (픽셀)
                    const minHeight = 400; // 최소 높이 (픽셀)
                    const minRatio = 0.1;  // 최소 비율 (예: 1:10)
                    const maxRatio = 10;   // 최대 비율 (예: 10:1)

                    if (img.width > maxWidth || img.height > maxHeight) {
                        alert(`이미지 크기가 너무 큽니다. ${maxWidth}x${maxHeight} 픽셀 이하의 파일을 업로드해주세요.`);
                        return;
                    }

                    if (img.width < minWidth || img.height < minHeight) {
                        alert(`이미지 크기가 너무 작습니다. ${minWidth}x${minHeight} 픽셀 이상의 파일을 업로드해주세요.`);
                        return;
                    }

                    const ratio = img.width / img.height;
                    if (ratio < minRatio || ratio > maxRatio) {
                        alert(`이미지 비율이 적절하지 않습니다. 가로 세로 비율이 1:${1/minRatio} 에서 1:${maxRatio} 사이여야 합니다.`);
                        return;
                    }

                    // 이미지 규격에 맞으면 프로필 사진으로 설정
                    profilePicture.src = e.target.result;
                }
                img.src = e.target.result;
            }
            reader.readAsDataURL(file);
        }
    });

      // 오늘 날짜를 yyyy-mm-dd 형식으로 반환하는 함수
      function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0'); // 월은 0부터 시작하므로 +1
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // 오늘 날짜를 가져와서 input 요소의 min 속성에 설정
        const todayDate = getTodayDate();
        document.getElementById('start_date').min = todayDate;
        document.getElementById('end_date').min = todayDate;
</script>